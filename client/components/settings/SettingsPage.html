<template name="settings">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-6">Settings</h1>
    
    <!-- Ozwell AI Integration Settings -->
    <div class="card bg-base-100 shadow-md p-6 mb-6">
      <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
        <span class="text-2xl"></span>
        Add Ozwell
      </h2>
      
      {{#if ozwellEnabled}}
        <div class="alert alert-success mb-4">
          <span>Ozwell is enabled and ready to help!</span>
        </div>
        
        <div class="mb-4">
          <p class="text-sm text-gray-600 mb-2">API Key: ••••••••••••{{lastFourChars}}</p>
          <p class="text-sm text-gray-500">Last connected: {{formatDate lastConnected}}</p>
        </div>
        
        <div class="flex gap-2">
          <button id="testOzwellConnection" class="btn btn-outline btn-primary" {{testConnectionAttrs}}>
            {{#if isTestingConnection}}
              <span class="loading loading-spinner loading-sm"></span>
              Testing...
            {{else}}
              Test Connection
            {{/if}}
          </button>
          <button id="updateOzwellKey" class="btn btn-outline">
            Update API Key
          </button>
          <button id="disableOzwell" class="btn btn-outline btn-error">
            Disable Ozwell
          </button>
        </div>
        
        {{#if connectionTestResult}}
          <div class="alert {{connectionTestClass}} mt-4">
            <span>{{connectionTestResult}}</span>
          </div>
        {{/if}}
      {{else}}
        <div class="alert alert-info mb-4">
          <span>ℹ️ Enable Ozwell AI to get intelligent writing suggestions for your activity titles and notes.</span>
        </div>
        
        <div class="mb-4">
          <h3 class="font-semibold mb-2">How to get your Ozwell API Key:</h3>
          <ol class="list-decimal list-inside text-sm text-gray-600 space-y-1">
            <li>Visit <a href="https://ai.bluehive.com" target="_blank" class="link link-primary">Ozwell AI Dashboard</a></li>
            <li>Sign up or log in to your account</li>
            <li>Go to API Settings and generate a new API key</li>
            <li>Copy the API key and paste it below</li>
          </ol>
        </div>
        
        <form id="enableOzwellForm">
          <div class="form-control mb-4">
            <label class="label">
              <span class="label-text">Ozwell API Key</span>
            </label>
            <input type="password" name="apiKey" placeholder="Enter your Ozwell API key" class="input input-bordered w-full" required />
            <label class="label">
              <span class="label-text-alt">Your API key is stored securely and only used for creating new AI sessions</span>
            </label>
          </div>
          
          <button type="submit" class="btn btn-primary" {{enableFormAttrs}}>
            {{#if isEnabling}}
              <span class="loading loading-spinner loading-sm"></span>
              Enabling...
            {{else}}
              Enable Ozwell AI
            {{/if}}
          </button>
        </form>
      {{/if}}
      
      {{#if ozwellError}}
        <div class="alert alert-error mt-4">
          <span>{{ozwellError}}</span>
        </div>
      {{/if}}
    </div>
    
    <!-- Account Settings -->
    <div class="card bg-base-100 shadow-md p-6">
      <h2 class="text-xl font-semibold mb-4">Account</h2>
      
      <div class="mb-4">
        <p class="text-sm text-gray-600">Logged in as: <strong>{{currentUser.username}}</strong></p>
        <p class="text-sm text-gray-500">Member since: {{formatDate currentUser.createdAt}}</p>
      </div>
      
      <button class="btn btn-outline btn-error">
        Change Password
      </button>
    </div>
  </div>
</template>